@namespace Masa.Stack.Components.GlobalNavigations
@inject DynamicTranslateProvider TranslateProvider
@inherits MasaComponentBase

@if (Data is not null)
{
    var indeterminate = Indeterminate;

    <MHover Disabled="@IsDisabled">
        @if (Data.IsAction is false)
        {
            <MListItem @attributes="@context.Attrs"
                       Class="@GetClass(context.Hover)"
                       Value="@Data.Code"
                       Disabled="@IsDisabled"
                       OnClick="SelectItem"
                       ActiveClass="@ActiveClass">
                <ItemContent Context="item">
                    <MListItemContent>
                        <MListItemTitle Style="@(IsChecked?"color: #323D6F;":"")">@Name</MListItemTitle>
                    </MListItemContent>
                    <MListItemAction Class="ma-0" Style="@GetIsDisplayStyle(context.Hover)">
                        @if (Checkable)
                        {
                            <MCheckbox Color="primary" Indeterminate=indeterminate Dense Value="@(indeterminate || IsChecked)" />
                        }
                        else if (Favorite && Level < 3)
                        {
                            <SAutoLoadingButton Icon
                                                XSmall
                                                Color="@(IsChecked ? "#FFB547" : "")"
                                                OnClick="AddFavorite"
                                                StopPropagation>
                                <MIcon Small>mdi-star</MIcon>
                            </SAutoLoadingButton>
                        }
                    </MListItemAction>
                    @if(context.Hover is false)
                    {
                        if (Checkable)
                        {
                            if(IsChecked)
                            {
                                <MIcon Small Class="mr-1" Color="primary">mdi-check</MIcon>
                            }
                            else if (Data.HasActions is false && Data.Reversed)
                            {
                                <MIcon Small Class="mr-1" Color="red">mdi-close</MIcon>
                            }
                            else if (indeterminate)
                            {
                                <MIcon Small Class="mr-1" Color="primary">mdi-minus-box</MIcon>
                            }
                        }
                        else if (Favorite && IsChecked)
                        {
                            <MIcon Small Style="margin-right: 6px" Color="#FFB547">mdi-star</MIcon>
                        }
                    }
                   
                </ItemContent>
            </MListItem>
        }
        else
        {
            <MListItem @attributes="@context.Attrs"
                       Class="@GetClass(context.Hover)"
                       Disabled="IsDisabled"
                       OnClick="SelectItem"
                       Value="@string.Format(ExpansionApp.ActionCodeFormat, ParentCode, Data.Code)"
                       ActiveClass="@ActiveClass">
                <ItemContent Context="item">
                    <MListItemContent>
                        <MListItemTitle Style="@(IsChecked?"color: #323D6F;":"")">@Name</MListItemTitle>
                    </MListItemContent>

                    @if (Checkable)
                    {
                        <MListItemAction Class="ma-0" Style="@GetIsDisplayStyle(context.Hover)">
                            <MCheckbox Dense Value="@IsChecked"></MCheckbox>
                        </MListItemAction>
                        @if (context.Hover is false)
                        {
                            if (IsChecked)
                            {
                                <MIcon Small Class="mr-1" Color="primary">mdi-check</MIcon>
                            }
                            else if (Data.Reversed)
                            {
                                <MIcon Small Class="mr-1" Color="red">mdi-close</MIcon>
                            }
                        }
                    }
                </ItemContent>
            </MListItem>
        }
    </MHover>
}
