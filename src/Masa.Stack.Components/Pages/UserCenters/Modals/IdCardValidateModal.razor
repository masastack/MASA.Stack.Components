@namespace Masa.Stack.Components.UserCenters
@inherits MasaComponentBase

<SModal @bind-Value="_visible"
              Title="@T("IdentityCardAuth")"
              FormModel="IdCardAuth"
              OnCancel="HandleOnCancel"
              OnSave="HandleOnOk">
    <MRow>
        <MCol Cols="12">
            <STextField @bind-Value="@IdCardAuth.Name"
                              Label="@T("RealName")">
            </STextField>
        </MCol>
        <MCol Cols="12">
            <STextField @bind-Value="@IdCardAuth.Number"
                              Label="@("IdentityCardNumber")">
            </STextField>
        </MCol>
        <MCol Cols="12">TODO: date</MCol>
        <MCol Cols="12">TODO: 详情地址</MCol>
        <MCol Cols="12">TODO: Images</MCol>
    </MRow>
</SModal>

@code {

    [Parameter]
    public EventCallback OnFinish { get; set; }

    private bool _visible;

    private IdentityCardAuthentication IdCardAuth { get; set; } = new();

    internal void Open()
    {
        _visible = true;
        StateHasChanged();
    }

    private void HandleOnCancel()
    {
        IdCardAuth = new();
        _visible = false;
    }

    private async Task HandleOnOk()
    {
        // TODO: id card save
        
        // success
        await OnFinish.InvokeAsync();
    }

}
